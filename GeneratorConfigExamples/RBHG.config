# RBHG Configuration File
# ======================
# Human-readable configuration for RBHG physics simulation pipeline.
# Edit these values to customize your simulation runs.
#
# Format: KEY VALUE  (separated by whitespace)
# Lines starting with # are comments and ignored  
# Only the first two values per line are used
# For file paths: Must specify full path


# =============================================================================
# GENERATOR IDENTIFICATION (for swif2_gen.py dispatcher)
# =============================================================================
GENERATOR_TYPE               RBHG

# =============================================================================
# USER SETTINGS
# =============================================================================
USERNAME                     acschick

# =============================================================================
# FILE PATHS AND DIRECTORIES
# =============================================================================
# FRAMEWORK_HOME: Root directory of the swif2-generator-framework
# This should point to the directory containing generators/, hddm_scripts/, RunPeriods.json, etc.
# Example: /work/halld/home/YOUR_USERNAME/swif2-generator-framework
#
# If left blank or not set, defaults to script location (auto-detects framework root)
FRAMEWORK_HOME               # Auto-detected: /w/halld-scshelf2101/home/acschick/channels/epemmissprot/newRBHG/RBHG/swif2-generator-framework

# Template and script files (relative to FRAMEWORK_HOME or absolute paths)
FORTRAN_TEMPLATE             temp_lepton_event_v113.f
JOB_SCRIPT                   swif2_RBHG_script.sh
ENV_FILE                     /group/halld/www/halldweb/html/halld_versions/version.xml

# =============================================================================
# OUTPUT DIRECTORY CONFIGURATION
# =============================================================================
# Three modes for organizing analysis pipeline outputs:
#   1. EXPLICIT: Uses base directory + standard study structure
#              Example: {BASE_DIR}/{STUDY_NAME}/{NAMETAG_FORMFACTOR_RADIATION_POL}/{step}/
#              So if {BASE_DIR} = /volatile/halld/home/{USERNAME}/{GENERATOR_TYPE}, then:
#              Result:  /volatile/halld/home/user/RBHG/Study1/BCFFN_IRADOFF_45DEG/simulation/
#   2. NESTED:   This step creates subdirectory in previous step's output
#              Example: simulation/ -> simulation/DSelector/ -> simulation/DSelector/TMVA/
#   3. SIBLING:  This step creates directory alongside previous at same level
#              Example: simulation/, DSelector/, TMVA/ (all siblings in study directory)
#
# BASE_DIR is where the organized study structure gets built (includes hists, trees, etc.)

GENERATOR_OUTPUT_DIR_BASE         {FRAMEWORK_HOME}/output/{GENERATOR_TYPE}/
MCWRAPPER_OUTPUT_DIR_BASE         /volatile/halld/home/{USERNAME}/{GENERATOR_TYPE}/              # Full path OR "NESTED" OR "SIBLING"  
DSELECTOR_OUTPUT_DIR_BASE         SIBLING                                            # Full path OR "NESTED" OR "SIBLING"
TMVA_OUTPUT_DIR_BASE              SIBLING                                            # Full path OR "NESTED" OR "SIBLING"
LOG_DIR_BASE                      /farm_out/{USERNAME}/{GENERATOR_TYPE}/

# =============================================================================
# STUDY MODE FLAGS
# =============================================================================
PRESIM_STUDY                 False          # theta min changes from 0.75 deg to 1.5 deg
COHERENT_PEAK_STUDY          False          # Sets E0 inside coherent peak range (8.2, 8.8)

# =============================================================================
# EVENT COUNT CONFIGURATION
# =============================================================================
# Two modes for event count configuration:
#
# 1. FIXED_EVENT_COUNT = True (Simple mode)
#    - Use NEVENTS_TOTAL and NEVENTS_PERFILE for all runs
#    - Ignores RunPeriods.json event counts
#    - Good for quick tests or custom event counts
#
# 2. FIXED_EVENT_COUNT = False (Auto mode, uses RUN_PERIOD)
#    - Loads event counts from RunPeriods.json for each run period/polarization
#    - Matches real data statistics automatically
#    - NEVENTS_TOTAL and NEVENTS_PERFILE used as fallbacks if lookup fails
#    - You can set NEVENTS_TOTAL = "usePreset" to make it explicit that
#      preset values will be used (avoids confusion about which number applies)
#
# Note: NEVENTS_TOTAL and NEVENTS_PERFILE are the ONLY event count settings.
#       No more separate NEVENTS_FIXED vs NEVENTS_TOTAL_CUSTOM confusion!

FIXED_EVENT_COUNT            True              # True = use values below, False = load from RunPeriods.json
NEVENTS_TOTAL                5000          # Total events to generate (or "usePreset" for auto mode)
TENX_FLAG                    False              # Multiply event counts by 10x
RUN_PERIOD                          # Valid: 1801, 1808, FULL2018, 2205, or blank
                                                 # If blank: generates SINGLE job for POL_DEG specified below
                                                 #           Uses 1808 (GlueX) or 2205 (CPP) only for cobrems file selection
                                                 # If set (e.g. "1808"): generates ALL 4 polarizations (0,90,135,45) for that run period
                                                 # Add '_AMO' suffix: FULL2018_AMO (includes AMO data: 0,90,135,45,AMO)
                                                 # Add '_FFS' suffix: 1801_FFS for Form Factor Study (4 datasets: qDATAq, BC_FFN, BC_FF1, SIM_FF1)
                                                 # Combine: FULL2018_AMO_FFS

# =============================================================================
# GENERATOR CONTROL
# =============================================================================
STUDY_NAME                   v113_norad           # Top level directory name
NAMETAG                      A3             # e.g. BC, SIM, qDATAq
NEVENTS_PERFILE              5000          # Events per output file
FORM_FACTOR                  FFN            # Nuclear charge form factor: FFN (dipole) or FF1 (=1)
LEPTON                       ee             # Lepton type: ee (electron) or mu (muon)
BH_XSCTN_FORMULATION         Berlin         # Cross section: Berlin (polarized) or Heitler (unpolarized)
COBREMS_DISTRIBUTION         True           # Use experimental Coherent Bremsstrahlung vs 1/E
                                             # When True and RUN_PERIOD set (or defaults to 1808/2205):
                                             # automatically selects cobrems file for POL_DEG from RunPeriods.json
COBREMS_VARBIN               True          # Use variable-width tagger binning for bremsstrahlung
COBREMS_FILE_GLUEX                          # Override default GlueX cobrems file (blank = auto-select)
COBREMS_FILE_CPP                            # Override default CPP cobrems file (blank = auto-select)
INTERNAL_RADIATION           True           # Mo & Tsai internally radiated brem. photon
SINGLE_RADIATION             False          # post v113 feature: True=one lepton radiates, False=both radiate
HYPGEOM_RADIATION            False          # Future: hypergeometric radiation for lead target
POL_DEG                      90             # Beam polarization: 0, 90, 135, 45, or AMO
EXPERIMENT                   GlueX          # GlueX or CPP

# =============================================================================
# HISTOGRAM OUTPUT CONTROL
# =============================================================================
HIST_INVARIANT_MASS          True           # Invariant mass W
HIST_ENERGY_FRACTION_X       True           # Energy fraction x
HIST_MANDELSTAM_T            True           # Mandelstam t
HIST_T_VAR_BIN_WIDTH         True           # Mandelstam t with GlueX resolution bins
HIST_ELASTICITY              True           # Elasticity
HIST_MISSING_MASS            True           # Missing mass
HIST_THETA                   True           # Lab theta
HIST_PHI_OF_JT               True           # Polarization observable phi of J_T
HIST_EGAMMA                  True           # Incident photon energy

# =============================================================================
# OUTPUT CONTROL
# =============================================================================
ASCII_VECTOR_OUTPUT          True           # Write vector event file (4-vectors)
INTEGRAL_XSECTION            True           # Output integrated cross sections
VERBOSE_OUTPUT               True           # Print detailed convergence info (maximum xsctn*Brem)

# =============================================================================
# GLUEX EXPERIMENT PARAMETERS (Physics Generator Settings)
# =============================================================================
GLUEX_PHOTON_ENERGY_MIN      7.0            # GeV - Minimum photon energy to generate
GLUEX_PHOTON_ENERGY_MAX      11.4           # GeV - Maximum photon energy to generate  
GLUEX_ELECTRON_BEAM_ENERGY   11.4           # GeV - Electron beam energy
GLUEX_COHERENT_PEAK_EDGE     8.8            # GeV - Edge of the coherent peak
GLUEX_PHOTON_POLARIZATION    1.0            # Fraction of polarization of photon beam
GLUEX_LEPTON_THETA_MIN       0.75           # degrees - Minimum lepton theta to generate
GLUEX_LEPTON_THETA_MAX       14             # degrees - Maximum lepton theta to generate

# =============================================================================
# CPP EXPERIMENT PARAMETERS (Physics Generator Settings)  
# =============================================================================
CPP_PHOTON_ENERGY_MIN        4.5            # GeV - Minimum photon energy to generate
CPP_PHOTON_ENERGY_MAX        6.0            # GeV - Maximum photon energy to generate
CPP_ELECTRON_BEAM_ENERGY     11.0           # GeV - Electron beam energy
CPP_COHERENT_PEAK_EDGE       5.7            # GeV - Edge of the coherent peak
CPP_PHOTON_POLARIZATION      1.0            # Fraction of polarization of photon beam
CPP_LEPTON_THETA_MIN         0.3            # degrees - Minimum lepton theta to generate  
CPP_LEPTON_THETA_MAX         7              # degrees - Maximum lepton theta to generate

# =============================================================================
# SWIF2 JOB CONTROL (Event Generation)
# =============================================================================
PROJECT                      halld          # SLURM project name
TRACK                        production     # SLURM track
DISK_USAGE                   100MB          # Disk space per job
RAM_USAGE                    100MB          # RAM per job
TIME_LIMIT                   6hrs           # Time limit per job
SHELL_EXECUTABLE             /bin/tcsh      # Shell for job scripts

# =============================================================================
# MCWRAPPER CONFIGURATION
# =============================================================================
MCWRAPPER_EVENTS_PER_FILE    500000         # Events per MCWrapper job file
MCWRAPPER_BATCH_MODE         2              # 0=interactive, 1=submit jobs, 2=submit and run workflow

# Environment file overrides (leave blank to use RunPeriods.json defaults based on RUN_PERIOD)
MCWRAPPER_RECON_ENV_OVERRIDE              # Override reconstruction environment XML
MCWRAPPER_ANALYSIS_ENV_OVERRIDE           # Override analysis environment XML

# Background matching (set to version string to include background, or NONE to exclude)
MCWRAPPER_BACKGROUND_VERSION              # e.g. recon-2018_01-ver02.2 or NONE (blank = use RunPeriods.json default)

# JANA Configuration - specify which jana config file to use
# Path can be absolute or relative to template_MCWrapper/jana_configs/
# Leave blank to use RunPeriods.json default based on RUN_PERIOD
MCWRAPPER_JANA_CONFIG_OVERRIDE            # e.g. custom_2018_epem.config or blank for default

# RCDB Query (leave blank to auto-generate from run period and polarization)
MCWRAPPER_RCDB_QUERY                        # e.g. "@is_2018production and (polarization_angle==0)"

# If True, set RBHGRUNRANGE to the "characteristic_run" listed in RunPeriods.json
# for the specified RUN_PERIOD and polarization. This overrides any explicit
# run_range passed in per-generation mcwrapper settings. Useful for producing
# simulations tied to one representative (characteristic) run instead of a
# full run range.
MCWRAPPER_USE_CHARACTERISTIC_RUN False
